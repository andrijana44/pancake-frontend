import BN from 'bignumber.js'
import { formatBigInt, formatBigIntToFixed, getFullDisplayBalance } from '@pancakeswap/utils/formatBalance'

describe('formatBigInt', () => {
  it.each([
    ['13853728395577367836', 4, 18, '13.8537'],
    ['13853728395577367836', 18, 18, '13.85372839557736846'],
    ['13853728395577367836', 17, 18, '13.85372839557736846'],
    ['13853728395577367836', 16, 18, '13.8537283955773685'],
    ['13853728395577367836', 15, 18, '13.853728395577368'],
    ['13853728395577367836', 14, 18, '13.85372839557737'],
    ['13853728395577367836', 13, 18, '13.8537283955774'],
    ['13853728395577367836', 12, 18, '13.853728395577'],
    ['13853728395577367836', 11, 18, '13.85372839558'],
    ['13853728395577367836', 10, 18, '13.8537283956'],
    ['13853728395577367836', 9, 18, '13.853728396'],
    ['13853728395577367836', 8, 18, '13.8537284'],
    ['13853728395577367836', 7, 18, '13.8537284'],
    ['13853728395577367836', 6, 18, '13.853728'],
    ['13853728395577367836', 5, 18, '13.85373'],
    ['13853728395577367836', 4, 18, '13.8537'],
    ['13853728395577367836', 3, 18, '13.854'],
    ['13853728395577367836', 2, 18, '13.85'],
    ['13853728395577367836', 1, 18, '13.9'],
    ['13853728395577367836', 0, 18, '14'],
    ['2652487215692514844', 2, 18, '2.65'],
    ['1120124117988485', 3, 18, '0.001'],
    ['1120124117988485', 1, 18, '0'],
    ['207655447689', 2, 9, '207.66'],
    ['6652397734197674016', 8, 18, '6.65239773'],
    ['23810432295393761', 18, 18, '0.023810432295393761'],
    ['23810432295393761', 9, 18, '0.023810432'],
    ['23810432295393761', 1, 18, '0.0'],
    ['1000000000000000000', 1, 18, '1'],
    ['0', 1, 18, '0'],
    ['0', 2, 18, '0'],
  ])('correctly formats %s (%d, %d) correctly to %s', (value, displayDecimals, decimals, expected) => {
    const bn = BigInt(value)
    expect(formatBigInt(bn, displayDecimals, decimals)).toBe(expected)
  })
})

describe('formatBigIntToFixed', () => {
  it.each([
    ['1000000000000000000', 2, 18, '1.00'],
    ['1000000000000000000', 6, 18, '1.000000'],
    ['1200000000000000000', 3, 18, '1.200'],
    ['1020100000000000000', 6, 18, '1.020100'],
    ['1000000000000000000', 0, 18, '1'],
  ])('correctly formats %s (%d, %d) correctly to %s', (value, displayDecimals, decimals, expected) => {
    const bn = BigInt(value)
    expect(formatBigIntToFixed(bn, displayDecimals, decimals)).toBe(expected)
  })
})

describe('getFullDisplayBalance', () => {
  it.each([
    ['9763410526137450427.1196', 3, 18, '9.763'],
    ['9763410526137450427.1196', 1, 18, '9.8'],
    ['9763410526137450427.1196', 0, 18, '10'],
    ['567008695201201503619.22', 18, 18, '567.008695201201503619'],
    ['567008695201201503619.22', 5, 18, '567.0087'],
    ['97634105261.1196', 3, 9, '97.634'],
    ['97634105261', 1, 9, '97.6'],
    ['97634105261', 0, 9, '98'],
  ])('correctly formats %s (%d, %d) correctly to %s', (value, displayDecimals, decimals, expected) => {
    expect(getFullDisplayBalance(new BN(value), decimals, displayDecimals)).toBe(expected)
  })
})
